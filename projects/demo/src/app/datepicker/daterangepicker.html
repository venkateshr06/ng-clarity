<!--
  ~ Copyright (c) 2016-2023 VMware, Inc. All Rights Reserved.
  ~ This software is released under MIT license.
  ~ The full license information can be found in LICENSE in the root directory of this project.
  -->

<h2>Date Range Picker</h2>

<form clrForm [formGroup]="dateForm" novalidate>
  <section class="date-range-section">
    <h4>Standard Format</h4>
    <div class="flex-section">
      <!-- Variant 1 -->
      <div class="card" data-heading="Variant: mm/dd/yyyy">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'MM/dd/yyyy', startDtFc: 'startDateV1', endDtFc: 'endDateV1', minDateFc: 'minDateV1', maxDateFc: 'maxDateV1' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateV1', maxDateFc: 'maxDateV1' }"
            ></ng-container>
          </div>
        </div>
      </div>
      <!-- Variant 2 -->
      <div class="card" data-heading="Variant: dd/mm/yyyy ">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'dd/MM/yyyy', startDtFc: 'startDateV2', endDtFc: 'endDateV2', minDateFc: 'minDateV2', maxDateFc: 'maxDateV2' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateV2', maxDateFc: 'maxDateV2' }"
            ></ng-container>
          </div>
        </div>
      </div>

      <!-- Variant 3 -->
      <div class="card" data-heading="Variant: dd/mmm/yyyy ">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'dd/MMM/yyyy', startDtFc: 'startDateV3', endDtFc: 'endDateV3', minDateFc: 'minDateV3', maxDateFc: 'maxDateV3' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateV3', maxDateFc: 'maxDateV3' }"
            ></ng-container>
          </div>
        </div>
      </div>

      <!-- Variant 4 -->
      <div class="card" data-heading="With Range Options">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'MM/dd/yyyy', rangeOptions: dateRangeOptions, startDtFc: 'startDateWithOptionV1', endDtFc: 'endDateWithOptionV1', minDateFc: 'minDateWithOptionV1', maxDateFc: 'maxDateWithOptionV1' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateWithOptionV1', maxDateFc: 'maxDateWithOptionV1' }"
            ></ng-container>
          </div>
        </div>
      </div>
    </div>

    <h4>Year & Month Picker</h4>
    <div class="flex-section">
      <!-- Variant 5 -->
      <div class="card" data-heading="Variant: yyyy/mm">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'yyyy/MM', startDtFc: 'startDateYearMonthV1', endDtFc: 'endDateYearMonthV1', minDateFc: 'minDateYearMonthV1', maxDateFc: 'maxDateYearMonthV1' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateYearMonthV1', maxDateFc: 'maxDateYearMonthV1' }"
            ></ng-container>
          </div>
        </div>
      </div>

      <!-- Variant 6 -->
      <div class="card" data-heading="Variant: mmm yyyy">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'MMM yyyy', startDtFc: 'startDateYearMonthV2', endDtFc: 'endDateYearMonthV2', minDateFc: 'minDateYearMonthV2', maxDateFc: 'maxDateYearMonthV2' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateYearMonthV2', maxDateFc: 'maxDateYearMonthV2' }"
            ></ng-container>
          </div>
        </div>
      </div>

      <!-- Variant 7 -->
      <div class="card" data-heading="With Range Options">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'yyyy/MM', rangeOptions: monthRangeOptions, startDtFc: 'startDateYearMonthWithOptionV1', endDtFc: 'endDateYearMonthWithOptionV1', minDateFc: 'minDateYearMonthWithOptionV1', maxDateFc: 'maxDateYearMonthWithOptionV1' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateYearMonthWithOptionV1', maxDateFc: 'maxDateYearMonthWithOptionV1' }"
            ></ng-container>
          </div>
        </div>
      </div>
    </div>

    <h4>Month Picker</h4>
    <div class="flex-section">
      <!-- Variant 8 -->
      <div class="card" data-heading="Variant: mmm">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'MMM', startDtFc: 'startDateMonthV1', endDtFc: 'endDateMonthV1', minDateFc: 'minDateMonthV1', maxDateFc: 'maxDateMonthV1' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateMonthV1', maxDateFc: 'maxDateMonthV1' }"
            ></ng-container>
          </div>
        </div>
      </div>
    </div>

    <h4>Year Picker</h4>
    <div class="flex-section">
      <!-- Variant 9 -->
      <div class="card" data-heading="Variant: yyyy">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'yyyy', startDtFc: 'startDateYearV1', endDtFc: 'endDateYearV1', minDateFc: 'minDateYearV1', maxDateFc: 'maxDateYearV1' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateYearV1', maxDateFc: 'maxDateYearV1' }"
            ></ng-container>
          </div>
        </div>
      </div>

      <!-- Variant 10 -->
      <div class="card" data-heading="With Range Options">
        <div class="card-content">
          <ng-container
            *ngTemplateOutlet="daterange; context: { dateFormat: 'yyyy', rangeOptions: yearRangeOptions, startDtFc: 'startDateYearWithOptionV1', endDtFc: 'endDateYearWithOptionV1', minDateFc: 'minDateYearWithOptionV1', maxDateFc: 'maxDateYearWithOptionV1' }"
          ></ng-container>
        </div>
        <div class="card-validations">
          <div class="form-input-wrapper clr-form-horizontal">
            <ng-container
              *ngTemplateOutlet="validators; context: { minDateFc: 'minDateYearWithOptionV1', maxDateFc: 'maxDateYearWithOptionV1' }"
            ></ng-container>
          </div>
        </div>
      </div>
    </div>
  </section>
</form>
<ng-template #validators let-minDateFc="minDateFc" let-maxDateFc="maxDateFc">
  <ng-container [formGroup]="dateForm">
    <clr-input-container>
      <label>Min Date</label>
      <input type="text" placeholder="yyyy-mm-dd" [formControlName]="minDateFc" clrInput />
    </clr-input-container>

    <clr-input-container>
      <label>Max Date</label>
      <input type="text" placeholder="yyyy-mm-dd" clrInput [formControlName]="maxDateFc" />
    </clr-input-container>
  </ng-container>
</ng-template>

<ng-template
  #daterange
  let-dateFormat="dateFormat"
  let-minDateFc="minDateFc"
  let-maxDateFc="maxDateFc"
  let-startDtFc="startDtFc"
  let-rangeOptions="rangeOptions"
  let-endDtFc="endDtFc"
>
  <ng-container [formGroup]="dateForm">
    <clr-date-range-container
      [min]="dateForm.get(minDateFc).value"
      [max]="dateForm.get(maxDateFc).value"
      [rangeOptions]="rangeOptions"
      [dateFormat]="dateFormat"
    >
      <!-- <label for="dateRangeCtrl">Range Picker</label> -->
      <input
        [id]="startDtFc"
        aria-labelledby="dateRangeCtrl"
        name="startDate"
        type="date"
        clrRangeStartDate
        (clrRangeStartDateChange)="stDateChanged($event)"
        [formControlName]="startDtFc"
      />
      <input
        [id]="endDtFc"
        aria-labelledby="dateRangeCtrl"
        name="endDate"
        type="date"
        clrRangeEndDate
        (clrRangeEndDateChange)="endDateChanged($event)"
        [formControlName]="endDtFc"
      />
      <clr-control-error *clrIfError="'min'">
        <ng-container *ngIf="dateForm.get(startDtFc).errors?.min?.min || dateForm.get(endDtFc).errors?.min?.min">
          Minimum date should be {{dateForm.get(startDtFc).errors?.min?.min || dateForm.get(endDtFc).errors?.min?.min}}
        </ng-container>
      </clr-control-error>
      <clr-control-error *clrIfError="'max'">
        <ng-container *ngIf="dateForm.get(startDtFc).errors?.max?.max || dateForm.get(endDtFc).errors?.max?.max">
          Maximum date should be {{dateForm.get(startDtFc).errors?.max?.max || dateForm.get(endDtFc).errors?.max?.max}}
        </ng-container>
      </clr-control-error>
      <clr-control-error *clrIfError="'range'">
        <ng-container
          *ngIf="dateForm.get(startDtFc).errors?.range?.range || dateForm.get(endDtFc).errors?.range?.range"
        >
          Start date must be less than End date
        </ng-container>
      </clr-control-error>
    </clr-date-range-container>
  </ng-container>
</ng-template>
